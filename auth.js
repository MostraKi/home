import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js"; import { getAuth, onAuthStateChanged, sendPasswordResetEmail, signOut, signInWithEmailAndPassword, signInWithPopup, GoogleAuthProvider } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
const firebaseConfig = { apiKey: "AIzaSyCE2Q4UXC9rzWjtmWIy3aa6e56sWk80TqY", authDomain: "mostraki-8dc92.firebaseapp.com", projectId: "mostraki-8dc92", storageBucket: "mostraki-8dc92.appspot.com", messagingSenderId: "932409459380", appId: "1:932409459380:web:1ec374091f4498d692cde1", measurementId: "G-PRPG5CLE5W" };
const app = initializeApp(firebaseConfig); const auth = getAuth(app);
window.login = function () { const email = document.getElementById("email").value; const password = document.getElementById("password").value; signInWithEmailAndPassword(auth, email, password) .then(() => { alert("Login realizado com sucesso!"); closeModal(); }) .catch(error => { alert("Erro ao fazer login: " + error.message); }); };
window.resetarSenha = function () { const email = document.getElementById("email").value; if (!email) { alert("Digite seu e-mail para redefinir a senha."); return; } sendPasswordResetEmail(auth, email) .then(() => { alert("Enviamos um link para redefinir sua senha. Verifique sua caixa de entrada."); }) .catch(error => { alert("Erro ao enviar e-mail de redefinição: " + error.message); }); };
window.loginComGoogle = function () { const provider = new GoogleAuthProvider(); signInWithPopup(auth, provider) .then((result) => { const isNewUser = result._tokenResponse?.isNewUser; alert(isNewUser ? "Cadastro realizado com sua conta Google!" : "Login realizado com Google!"); closeModal(); }) .catch((error) => { if (error.code === 'auth/popup-closed-by-user') { alert("O login com Google foi cancelado."); } else { alert("Erro ao fazer login com Google: " + error.message); } }); };
window.logout = function () { signOut(auth).then(() => { alert("Você saiu da sua conta."); location.reload(); }).catch((error) => { alert("Erro ao sair: " + error.message); }); };
window.handleAuthAction = function () { const text = document.getElementById("authText").textContent; if (text === "Entrar") { openModal(); } else if (text === "Sair") { logout(); } };
onAuthStateChanged(auth, (user) => { const userCircle = document.getElementById("userCircle"); const authText = document.getElementById("authText"); if (user) { const nome = user.displayName || user.email; const iniciais = nome.trim().charAt(0).toUpperCase(); userCircle.textContent = iniciais; userCircle.style.display = "flex"; authText.textContent = "Sair"; authText.style.display = "inline"; } else { userCircle.style.display = "none"; authText.textContent = "Entrar"; authText.style.display = "inline"; } });